# 基于SEED数据集的脑电情绪识别项目

## 数据集介绍

####  1. **被试与实验设计**

- 共 **15 名被试**（编号为 1 到 15）

- 每名被试参与 **3 次独立实验 session**（基本间隔一周以上，减少记忆效应）

- 因此总共有：**15 人 × 3 sessions = 45 个实验文件**

  数据集文件结构如下：

  ```bash
  SEED/
  ├── 1/                 # 被试1
  │   ├── 1_20131027.mat  # session 1
  │   ├── 1_20131030.mat  # session 2
  │   └── 1_20131107.mat  # session 3
  ├── 2/
  │   ├── 2_20140404.mat
  │   └── ...
  ...
  └── 15/
  │   └── ...
  └──label.mat
  ```

---

#### 2. 单个 `.mat` 文件内容

 一个被试的一次session（比如 `1_xxx.mat`）包含 15 个trial

```json
dict_keys([
    '__header__', '__version__', '__globals__',
    'djc_eeg1', 'djc_eeg2', ..., 'djc_eeg15'
])
```

`djc_eeg1` 到 `djc_eeg15`：对应 **15 个电影片段 trial**

- 前缀 `djc` 是被试代号（不同被试前缀不同，如 `djc_eeg1`、`jl_eeg1` 等）

- 每个变量是一个 NumPy 数组，形状如下：

  ```json
  (62, T)
  ```

  - `62`：EEG 通道数（扩展 10–20 系统）
  - `T`：时间点数量（采样率 200 Hz × 视频时长约 4 分钟 → T ≈ 48,000）

- 这 15 个 trial 的情绪标签是**固定顺序**的（官方设定）

  ```json
  [1, 0, -1, -1, 0, 1, -1, 0, 1, 1, 0, -1, 0, 1, -1]
  ```

  - `1` = positive（积极）
  - `0` = neutral（中性）
  - `-1` = negative（消极）

> 📌 注意：**所有被试、所有 session 都观看完全相同的15个电影片段，使用相同的标签顺序**。

------

#### 3.官方数据预处理

根据 SEED 官网和原始论文，数据已经过以下处理：

- 采样率：**200 Hz**
- 滤波：**带通 0–75 Hz**

----

## 实验设计

根据我们的调研，情绪识别的核心目标是“泛化到新用户”，因此必须保证：

- 模型对没见过的人仍然有效
- 避免数据泄漏

所以我们以**跨被试**实验为主，训练数据采用`14个被试 `x `3session`，测试数据采用`1个被试` x `3session`。

同时使用 **留一法** 进行交叉验证。

-------

## 数据预处理

关于 **SEED 数据集的预处理**，目标是：**在保留情绪相关神经活动的同时，最大限度抑制噪声和个体差异**。

对于一个被试的一次session实验，先通过键名索引到最小的数据单元（即一次实验的电位数据），形状为 `(62, T)` ，记作 `X_raw` 。`T` 表示采样时间点的总长度。下面是对 `X_raw` 的数据预处理流程：

1. 信号截取

   我们截取 `30-120 s` 时间段的信号

   目的：排除实验开始的适应期和结束时的疲劳期，提取到情绪体验比较稳定的EEG信号段。

2. 重参考-CAR(共同平均参考)

   （可以了解背景：为什么 EEG 需要“参考”？）

   数据发布前已经经过了一次参考：**统一转换为双乳突平均参考**

   ```py
   X_ref = X_raw - np.mean(X_raw, axis=0, keepdims=True)
   ```

   目的：我的理解是为了让不同通道间的真实相对差异**更清晰、更可靠**，做参考可能带来的好处就是[ **给所有数据去掉某个整体的偏移量** | **使得数据分布的空间不对称性更加清晰的体现** ]

3. 带通滤波

   保留情绪相关的生理频段（4-45Hz）

   目的：去除低频漂移、工频干扰和高频噪声

4. 频带分解

   ```json
   bands = {'delta':(1,4), 'theta':(4,8), 'alpha':(8,14), 'beta':(14,31), 'gamma':(31,50)}
   ```

   不同情绪在不同频带有特异性表现

   目的：分离不同生理意义的脑电节律

5. 微分熵计算

   **微分熵（DE）** 是衡量一个连续信号（如 EEG）**波动剧烈程度/信息量**的一个指标

   - **DE 越高** → 信号越“混乱”、能量越强（比如 beta 波活跃）
   - **DE 越低** → 信号越“平稳”（比如 alpha 波节律性强）

经过一系列的处理最终将原始的 `X_raw` 从 `(62, T)` -> `(310,)` 

------------

## 实验结果

1. `DE` 微分熵特征提取 + `SVM` 分类模型

   作为 breanchmark 模型，进行了很多次的探索；综合前期多组实验的结果，确立基准模型，作为后续特征工程改进的起点。

   15个被试的平均分类准确率为 `0.527`。在调参上，`线性核` 和 `rbf核` 平分秋色，所以使用网格搜索来选择每次实验最佳的参数

   

2. 浅层特征提取 + `mlp` 分类

   出现的问题：被试在测试时准确率的表现总是围绕0.33上下浮动，各种排错…

